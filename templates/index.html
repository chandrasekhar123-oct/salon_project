<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Salon Booking ‚Äì Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}" />
</head>

<body>
  <div class="app">
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    <!-- Sidebar for Laptop/Desktop -->
    <aside class="sidebar">
      <div class="logo" style="display: flex; align-items: center; gap: 0.75rem;">
        <div
          style="background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); width: 42px; height: 42px; border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 16px rgba(99, 102, 241, 0.3);">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
        <span
          style="font-size: 1.6rem; font-weight: 850; letter-spacing: -0.5px; background: #312e81; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">SalonEase</span>
      </div>
      <nav class="sidebar-nav">
        <a href="#" class="sidebar-link sidebar-link--active" onclick="showScreen('screen-home')">
          <span class="sidebar-link__icon">üè†</span> Home
        </a>
        <a href="#" class="sidebar-link" onclick="showScreen('screen-bookings')">
          <span class="sidebar-link__icon">üìÖ</span> Bookings
        </a>
        <a href="#" class="sidebar-link" onclick="showScreen('screen-favorites')">
          <span class="sidebar-link__icon">‚ù§Ô∏è</span> Favorites
        </a>
        <a href="#" class="sidebar-link" onclick="showScreen('screen-profile')">
          <span class="sidebar-link__icon">üë§</span> Profile
        </a>
        {% if current_user.role == 'salon_owner' %}
        <a href="{{ url_for('owner_dashboard') }}" class="sidebar-link"
          style="margin-top: 1rem; background: #fdf2ff; border: 1px dashed #a855f7;">
          <span class="sidebar-link__icon">üìä</span> Owner Panel
        </a>
        {% endif %}
      </nav>

      {% if current_user.is_authenticated %}
      <div style="margin-top: auto; padding-top: 2rem;">
        <a href="{{ url_for('logout') }}" class="sidebar-link" style="color: #ef4444;">
          <span class="sidebar-link__icon">üö™</span> Logout
        </a>
      </div>
      {% endif %}
    </aside>

    <!-- Header -->
    <header class="app-header">
      <div class="app-header__location" style="display: flex; align-items: center; gap: 0.75rem;">
        <div id="city-icon"
          style="width: 40px; height: 40px; background: #fdf2ff; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; border: 1px solid #f3e8ff;">
          üïå
        </div>
        <div style="display: flex; flex-direction: column;">
          <span class="app-header__location-label">Current Location</span>
          <select class="app-header__location-value" id="location-selector" onchange="filterSalonsByLocation()"
            style="border: none; background: transparent; font-weight: 700; font-family: inherit; color: #111827; outline: none; cursor: pointer; padding: 0;">
            <option value="All Locations">All Locations</option>
            <option value="Hyderabad" selected>Hyderabad, India</option>
            <option value="Bengaluru">Bengaluru, India</option>
            <option value="Mumbai">Mumbai, India</option>
            <option value="Delhi">Delhi, India</option>
            <option value="Pune">Pune, India</option>
          </select>
        </div>
      </div>
      <div class="app-header__search" style="flex: 1; max-width: 500px; margin: 0 2rem; position: relative;">
        <svg id="scissor-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ec4899"
          stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
          style="margin-right: 0.25rem; cursor: pointer;">
          <circle cx="6" cy="6" r="3"></circle>
          <circle cx="6" cy="18" r="3"></circle>
          <line x1="20" y1="4" x2="8.12" y2="15.88"></line>
          <line x1="14.47" y1="14.48" x2="20" y2="20"></line>
          <line x1="8.12" y1="8.12" x2="12" y2="12"></line>
        </svg>
        <input class="app-header__search-input" placeholder="Search for salons, services or style..." type="text" />
        <svg id="mic-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#a855f7" stroke-width="2.5"
          stroke-linecap="round" stroke-linejoin="round"
          style="margin-left: 0.25rem; cursor: pointer; transition: all 0.3s;">
          <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
          <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
          <line x1="12" y1="19" x2="12" y2="23"></line>
          <line x1="8" y1="23" x2="16" y2="23"></line>
        </svg>

        <!-- Search Suggestions Dropdown -->
        <div id="search-suggestions"
          style="display: none; position: absolute; top: 110%; left: 0; right: 0; background: white; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 1px solid #f3e8ff; z-index: 100; max-height: 300px; overflow-y: auto; padding: 0.5rem;">
        </div>
      </div>
      <div style="display: flex; gap: 1rem; align-items: center;">
        <!-- Settings Button & Dropdown -->
        <div style="position: relative;">
          <button class="app-header__icon-btn" id="settings-btn" onclick="toggleSettings(event)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"></circle>
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
              </path>
            </svg>
          </button>
          <div id="settings-dropdown"
            style="display: none; position: absolute; top: 120%; right: 0; width: 280px; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); border: 1px solid #f3e8ff; z-index: 1000; overflow: hidden; animation: slideUp 0.3s ease-out;">
            <!-- Header -->
            <div
              style="padding: 1.25rem; background: linear-gradient(135deg, #fdf2ff 0%, #ffffff 100%); border-bottom: 1px solid #f3e8ff;">
              <h4 style="margin: 0; font-size: 1rem; font-weight: 800; color: #1e293b;">App Dashboard</h4>
              <p style="margin: 0.25rem 0 0; font-size: 0.75rem; color: #64748b;">Manage your salon experience</p>
            </div>

            <div style="max-height: 450px; overflow-y: auto;">
              <!-- Section: Profile -->
              <div
                style="padding: 0.75rem 1rem 0.25rem; font-size: 0.7rem; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px;">
                Personal</div>
              <div style="padding: 0.5rem 0;">
                {% if current_user.role == 'salon_owner' %}
                <a href="{{ url_for('owner_dashboard') }}" style="text-decoration: none; color: inherit;">
                  <div class="sidebar-link"
                    style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer; color: #a855f7; font-weight: 700;">
                    <span>üè¢</span> <span>Owner Dashboard</span>
                  </div>
                </a>
                {% endif %}
                {% if current_user.role == 'worker' %}
                <a href="{{ url_for('worker_dashboard') }}" style="text-decoration: none; color: inherit;">
                  <div class="sidebar-link"
                    style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer; color: #ec4899; font-weight: 700;">
                    <span>üëî</span> <span>Expert Dashboard</span>
                  </div>
                </a>
                {% endif %}
                <div class="sidebar-link" onclick="handleSetting('Edit Profile')"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer;">
                  <span>üë§</span> <span>Edit Profile</span>
                </div>
                <div class="sidebar-link" onclick="handleSetting('Loyalty Points')"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer;">
                  <span>üåü</span> <span>Loyalty Points <small style="color: #a855f7; font-weight: 800;">(540
                      pts)</small></span>
                </div>
              </div>

              <!-- Section: Features -->
              <div
                style="padding: 0.75rem 1rem 0.25rem; font-size: 0.7rem; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px;">
                Features</div>
              <div style="padding: 0.5rem 0;">
                <div class="sidebar-link" onclick="handleSetting('Gift Cards')"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer;">
                  <span>üéÅ</span> <span>Gift Cards & Vouchers</span>
                </div>
                <div class="sidebar-link" onclick="handleSetting('Refer & Earn')"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer;">
                  <span>üí∞</span> <span>Refer & Earn ‚Çπ500</span>
                </div>
                <div class="sidebar-link" onclick="handleSetting('Service Analytics')"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer;">
                  <span>üìà</span> <span>Service Analytics</span>
                </div>
              </div>

              <!-- Section: Preferences -->
              <div
                style="padding: 0.75rem 1rem 0.25rem; font-size: 0.7rem; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px;">
                Preferences</div>
              <div style="padding: 0.5rem 0;">
                <div class="sidebar-link" onclick="toggleDarkMode()"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer; display: flex; justify-content: space-between;">
                  <div style="display: flex; gap: 0.75rem; align-items: center;"><span>üåì</span> <span>Dark Mode</span>
                  </div>
                  <div id="dark-mode-toggle"
                    style="width: 34px; height: 18px; background: #e2e8f0; border-radius: 10px; position: relative; transition: all 0.3s; border: 1px solid #cbd5e1;">
                    <div id="dark-mode-circle"
                      style="width: 14px; height: 14px; background: white; border-radius: 50%; position: absolute; top: 1px; left: 1px; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    </div>
                  </div>
                </div>
                <div class="sidebar-link" onclick="handleSetting('Language')"
                  style="margin: 0 0.5rem; padding: 0.7rem 1rem; font-size: 0.85rem; cursor: pointer;">
                  <span>üåç</span> <span>Language (English)</span>
                </div>
              </div>
            </div>

            <!-- Footer -->
            <div style="padding: 1rem; background: #f8fafc; border-top: 1px solid #f1f5f9;">
              {% if current_user.is_authenticated %}
              <a href="{{ url_for('logout') }}" style="text-decoration: none;">
                <button class="primary-button"
                  style="background: #ef4444; box-shadow: 0 8px 20px rgba(239, 68, 68, 0.2); font-size: 0.8rem; padding: 0.5rem;">Logout
                  Safely</button>
              </a>
              {% else %}
              <a href="{{ url_for('login') }}" style="text-decoration: none;">
                <button class="primary-button" style="font-size: 0.8rem; padding: 0.5rem;">Join Premium Member</button>
              </a>
              {% endif %}
            </div>
          </div>
        </div>

        <div style="position: relative;">
          <button class="app-header__icon-btn" id="notif-btn" onclick="toggleNotifications(event)">
            üîî
            <div
              style="position: absolute; top: 0; right: 0; width: 8px; height: 8px; background: #ef4444; border-radius: 50%; border: 2px solid white;">
            </div>
          </button>

          <!-- Notification Dropdown -->
          <div id="notif-dropdown"
            style="display: none; position: absolute; top: 120%; right: 0; width: 320px; background: white; border-radius: 16px; box-shadow: 0 15px 50px rgba(0,0,0,0.15); border: 1px solid #f3e8ff; z-index: 1000; overflow: hidden; animation: slideUp 0.3s ease-out;">
            <div
              style="padding: 1.25rem; border-bottom: 1px solid #f3e8ff; display: flex; justify-content: space-between; align-items: center;">
              <h3 style="margin: 0; font-size: 1rem; font-weight: 700;">Notifications</h3>
              <span style="font-size: 0.75rem; color: #a855f7; font-weight: 600; cursor: pointer;">Mark all as
                read</span>
            </div>

            <div style="max-height: 350px; overflow-y: auto;">
              <!-- Item 1 -->
              <div
                style="padding: 1rem; border-bottom: 1px solid #f8fafc; display: flex; gap: 1rem; cursor: pointer; transition: background 0.2s;"
                onmouseover="this.style.background='#fdf2ff'" onmouseout="this.style.background='white'">
                <div
                  style="width: 40px; height: 40px; background: #fdf2ff; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; flex-shrink: 0;">
                  üßñ‚Äç‚ôÄÔ∏è</div>
                <div>
                  <p style="margin: 0; font-size: 0.85rem; font-weight: 600;">Booking Confirmed!</p>
                  <p style="margin: 0.15rem 0 0; font-size: 0.75rem; color: #64748b;">Your appointment at Urban Style
                    Studio is set for tomorrow at 10 AM.</p>
                  <span style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.5rem; display: block;">2 mins ago</span>
                </div>
              </div>

              <!-- Item 2 -->
              <div
                style="padding: 1rem; border-bottom: 1px solid #f8fafc; display: flex; gap: 1rem; cursor: pointer; transition: background 0.2s;"
                onmouseover="this.style.background='#fdf2ff'" onmouseout="this.style.background='white'">
                <div
                  style="width: 40px; height: 40px; background: #fff1f2; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; flex-shrink: 0;">
                  üî•</div>
                <div>
                  <p style="margin: 0; font-size: 0.85rem; font-weight: 600;">Special Spa Offer</p>
                  <p style="margin: 0.15rem 0 0; font-size: 0.75rem; color: #64748b;">Get 20% OFF on Full Body Massage
                    this weekend. Book now!</p>
                  <span style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.5rem; display: block;">1 hour ago</span>
                </div>
              </div>

              <!-- Item 3 -->
              <div style="padding: 1rem; display: flex; gap: 1rem; cursor: pointer; transition: background 0.2s;"
                onmouseover="this.style.background='#fdf2ff'" onmouseout="this.style.background='white'">
                <div
                  style="width: 40px; height: 40px; background: #f0fdf4; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; flex-shrink: 0;">
                  ‚úÖ</div>
                <div>
                  <p style="margin: 0; font-size: 0.85rem; font-weight: 600;">Payment Successful</p>
                  <p style="margin: 0.15rem 0 0; font-size: 0.75rem; color: #64748b;">Invoice #SER-9802 for ‚Çπ1,200 has
                    been paid successfully.</p>
                  <span style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.5rem; display: block;">5 hours
                    ago</span>
                </div>
              </div>
            </div>

            <div style="padding: 0.75rem; background: #f8fafc; text-align: center; border-top: 1px solid #f1f5f9;">
              <span style="font-size: 0.8rem; font-weight: 700; color: #a855f7; cursor: pointer;">View all
                history</span>
            </div>
          </div>
        </div>

        {% if current_user.is_authenticated %}
        <div class="profile-avatar"
          style="width: 40px; height: 40px; cursor: pointer; background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); color: white; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-weight: 700; font-size: 1rem; box-shadow: 0 4px 10px rgba(168, 85, 247, 0.2);">
          {{ current_user.name[:2] | upper }}
        </div>
        {% else %}
        <a href="{{ url_for('login') }}" class="primary-button" style="width: auto;">Login</a>
        {% endif %}
      </div>
    </header>

    <main class="app-main">
      {% with messages = get_flashed_messages() %}
      {% if messages %}
      {% for message in messages %}
      <div class="flash-message" style="margin: 0 0 1rem 0;">{{ message }}</div>
      {% endfor %}
      {% endif %}
      {% endwith %}

      <!-- Home Screen -->
      <section id="screen-home" class="screen is-active">
        <div class="chip-row">
          <button class="chip chip--active" onclick="filterByCategory('all', this)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
            All Salons
          </button>

          <button class="chip" onclick="filterByCategory('Hair', this)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <circle cx="6" cy="6" r="3"></circle>
              <circle cx="6" cy="18" r="3"></circle>
              <line x1="20" y1="4" x2="8.12" y2="15.88"></line>
              <line x1="14.47" y1="14.48" x2="20" y2="20"></line>
              <line x1="8.12" y1="8.12" x2="12" y2="12"></line>
            </svg>
            Hair
          </button>

          <button class="chip" onclick="filterByCategory('Facial', this)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#06b6d4" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2z"></path>
              <path d="M8 10h.01"></path>
              <path d="M16 10h.01"></path>
              <path d="M12 16c2 0 3-1 3-1H9s1 1 3 1z"></path>
            </svg>
            Facial
          </button>

          <button class="chip" onclick="filterByCategory('Makeup', this)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ec4899" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 14l-7-7-4 4 3 3 1 4 3 1 4-4z"></path>
              <path d="M17 12l1 4 4-1M11 8l-4-4-4 4 4 4 4-4z"></path>
            </svg>
            Makeup
          </button>

          <button class="chip" onclick="filterByCategory('Spa', this)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2l3 9h9l-7 5 3 9-8-7-8 7 3-9-7-5h9l3-9z" fill="#d1fae5"></path>
            </svg>
            Spa
          </button>

          <button class="chip" onclick="filterByCategory('Nails', this)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="3"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M7 11c0 3.87 3.13 7 7 7s7-3.13 7-7V5l-7-2-7 2v6z"></path>
              <path d="M12 18v3"></path>
              <path d="M20 11a8 8 0 0 1-16 0"></path>
            </svg>
            Nails
          </button>
        </div>

        <h2 class="section-title">Verified Salons Nearby</h2>
        <div class="dashboard-grid">
          {% for salon in salons %}
          <article class="salon-card" data-location="{{ salon.location }}"
            data-categories="{{ salon.services | map(attribute='category') | unique | join(',') | lower }}">
            <div class="salon-card__image-container">
              <span class="salon-card__badge">Premium</span>
              <a href="{{ url_for('salon_details', salon_id=salon.id) }}"
                style="text-decoration: none; display: block;">
                <div class="salon-card__image-placeholder"
                  style="height: 180px; background: #fdf2ff; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;">
                  <!-- Background Pattern -->
                  <div
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.1; background-image: radial-gradient(#a855f7 1px, transparent 1px); background-size: 20px 20px;">
                  </div>

                  {% if "Glow" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#ec4899" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path
                      d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41" />
                    <circle cx="12" cy="12" r="4" fill="#fbcfe8" />
                  </svg>
                  {% elif "Urban" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#6366f1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="4" y="2" width="16" height="20" rx="2" ry="2" />
                    <path d="M9 22v-4h6v4M8 6h.01M16 6h.01M8 10h.01M16 10h.01M8 14h.01M16 14h.01" />
                  </svg>
                  {% elif "Mirror" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#06b6d4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 2v20M2 12h20M7 7l10 10M17 7L7 17" opacity="0.2" />
                    <path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10z" fill="#cffafe" />
                  </svg>
                  {% elif "Barber" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M11 3a2 2 0 1 0 2 0v18a2 2 0 1 0-2 0V3z" stroke="#3b82f6" fill="#3b82f6" opacity="0.2" />
                    <path d="M9 3h6v18H9z" />
                    <path d="M9 7h6M9 12h6M9 17h6" stroke="#fff" />
                  </svg>
                  {% elif "Smile" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#f43f5e" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 10c0 4.418 4.03 8 9 8s9-3.582 9-8c0-4.418-4.03-8-9-8s-9 3.582-9 8z" />
                    <path d="M8 13s1.5 2 4 2 4-2 4-2" />
                    <path d="M12 2l1 2M8 4l.5 2M16 4l-.5 2" />
                  </svg>
                  {% elif "Luxury" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#8b5cf6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2l3 9h9l-7 5 3 9-8-7-8 7 3-9-7-5h9l3-9z" fill="#ddd6fe" />
                    <path d="M12 11v6" stroke-width="2" />
                  </svg>
                  {% elif "Budget" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#10b981" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="6" width="20" height="12" rx="2" />
                    <circle cx="12" cy="12" r="3" fill="#d1fae5" />
                    <path d="M6 12h.01M18 12h.01" />
                  </svg>
                  {% elif "Velvet" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#d946ef" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2z" fill="#f5d0fe"
                      opacity="0.3" />
                    <path d="M22 12c-4.5 0-8 3.5-8 8m-6-16c0 4.5 3.5 8 8 8" />
                  </svg>
                  {% elif "Elite" in salon.name %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none"
                    stroke="#f59e0b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 3q5 0 9 6l3 9" />
                    <path d="M18 3q-5 0-9 6l-3 9" />
                    <circle cx="6" cy="18" r="2" />
                    <circle cx="18" cy="18" r="2" />
                    <path d="M12 12l3-3m0 0l-3-3m3 3H3" opacity="0.5" />
                  </svg>
                  {% else %}<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#eab308"
                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14" />
                  </svg>{% endif %}
                </div>
              </a>
            </div>
            <div class="salon-card__body">
              <div class="salon-card__row">
                <a href="{{ url_for('salon_details', salon_id=salon.id) }}"
                  style="text-decoration: none; color: inherit;">
                  <h3 class="salon-card__name">{{ salon.name }}</h3>
                </a>
                <span class="salon-card__rating">‚≠ê {{ salon.rating }}</span>
              </div>
              <p class="salon-card__meta">üìç {{ salon.location }}</p>

              <div style="margin-top: 1rem;">
                <h4 style="font-size: 0.85rem; color: #6b7280; text-transform: uppercase;">Available Services:</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem;">
                  {% for service in salon.services[:3] %}
                  <span class="chip" style="font-size: 0.75rem;">{{ service.name }}</span>
                  {% endfor %}
                  {% if salon.services|length > 3 %}
                  <span class="chip" style="font-size: 0.75rem;">+{{ salon.services|length - 3 }} more</span>
                  {% endif %}
                </div>
              </div>

              <div style="margin-top: 1.5rem;">
                <a href="{{ url_for('salon_details', salon_id=salon.id) }}" class="primary-button"
                  style="text-decoration: none; display: block; text-align: center; padding: 0.8rem;">
                  Book Now
                </a>
              </div>
            </div>
          </article>
          {% endfor %}
        </div>
        <!-- Empty State for Search -->
        <div id="empty-state" style="display: none; text-align: center; padding: 6rem 2rem;">
          <div style="font-size: 5rem; margin-bottom: 2rem; animation: float 3s infinite ease-in-out;">üîç</div>
          <h3 style="font-size: 1.5rem; font-weight: 800; color: #1e293b; margin-bottom: 0.5rem;">No salons found</h3>
          <p style="color: #64748b; font-size: 1rem;">We couldn't find anything matching your search.<br>Try adjusting
            your filters or locations!</p>
          <button class="primary-button" style="width: auto; margin: 2rem auto 0; padding: 0.75rem 2rem;"
            onclick="document.querySelector('.app-header__search-input').value=''; applyFilters();">Clear
            Search</button>
        </div>
      </section>

      <!-- Bookings Screen -->
      <section id="screen-bookings" class="screen">
        <h2 class="section-title">My Appointment History</h2>
        {% if user_bookings %}
        <div class="card-list">
          {% for b in user_bookings %}
          <div class="summary-card" style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <h3 style="margin: 0;">{{ b.service.name }}</h3>
              <p class="muted" style="margin: 0.25rem 0;">{{ b.salon.name }}</p>
              <div class="muted">{{ b.date }} at {{ b.time }}</div>
            </div>
            <div style="text-align: right;">
              <span class="chip" style="background: #ecfdf5; color: #059669; font-weight: 600;">{{ b.status }}</span>
              <div style="margin-top: 0.5rem; font-weight: bold;">‚Çπ{{ b.service.price | int }}</div>
            </div>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="empty-state" style="text-align: center; padding: 4rem 1rem;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">üìÖ</div>
          <p class="muted">You haven't made any bookings yet.</p>
          <button class="primary-button" style="width: auto; margin-top: 1rem;" onclick="showScreen('screen-home')">Book
            Now</button>
        </div>
        {% endif %}
      </section>

      <!-- Favorites Screen -->
      <section id="screen-favorites" class="screen">
        <h2 class="section-title">Saved Salons</h2>
        <p class="muted">No favorites yet. Tap the heart on any salon to save it.</p>
      </section>

      <!-- Profile Screen -->
      <section id="screen-profile" class="screen">
        <div class="auth-card profile-dashboard" style="max-width: 100%;">
          <div class="profile-header">
            <div class="profile-avatar" style="width: 80px; height: 80px; font-size: 2.5rem;">
              {% if current_user.is_authenticated %}{{ current_user.name[0] | upper }}{% else %}üë§{% endif %}
            </div>
            <div>
              <h2 style="margin: 0;">{% if current_user.is_authenticated %}{{ current_user.name }}{% else %}Guest User{%
                endif %}</h2>
              <p class="muted">{% if current_user.is_authenticated %}{{ current_user.email }}{% else %}Create an account
                to book salons{% endif %}</p>
            </div>
          </div>
          <hr style="border: 0; border-top: 1px solid #f3e8ff; margin: 2rem 0;">
          <div class="dashboard-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
            <div class="summary-card" style="text-align: center;">
              <h3>{{ user_bookings | length }}</h3>
              <p class="muted">Total Bookings</p>
            </div>
            <div class="summary-card" style="text-align: center;">
              <h3>‚Çπ 0</h3>
              <p class="muted">Wallet Balance</p>
            </div>
          </div>
          {% if current_user.role == 'worker' and worker %}
          <div style="margin-top: 2.5rem; padding-top: 2rem; border-top: 2px dashed #f3e8ff;">
            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.5rem;">
              <span style="font-size: 1.5rem;">üëî</span>
              <h3 style="margin: 0; font-size: 1.25rem; font-weight: 800; color: #1e293b;">Expert Professional Settings
              </h3>
            </div>

            <form action="{{ url_for('update_worker_profile') }}" method="POST"
              style="display: grid; gap: 1.25rem; background: #fdf2ff; padding: 1.5rem; border-radius: 20px; border: 1px solid #f3e8ff;">
              <div class="form-group">
                <label
                  style="display: block; font-size: 0.8rem; font-weight: 700; color: #64748b; margin-bottom: 0.5rem;">Professional
                  Specialization</label>
                <input type="text" name="specialization" value="{{ worker.role }}" class="auth-input"
                  style="background: white; margin: 0;" placeholder="e.g. Senior Stylist">
              </div>
              <div class="form-group">
                <label
                  style="display: block; font-size: 0.8rem; font-weight: 700; color: #64748b; margin-bottom: 0.5rem;">Public
                  Phone Number</label>
                <input type="text" name="phone" value="{{ worker.phone }}" class="auth-input"
                  style="background: white; margin: 0;" placeholder="Verified Phone">
              </div>
              <div class="form-group">
                <label
                  style="display: block; font-size: 0.8rem; font-weight: 700; color: #64748b; margin-bottom: 0.5rem;">Profile
                  Image URL</label>
                <input type="text" name="image_url" value="{{ worker.image_url }}" class="auth-input"
                  style="background: white; margin: 0;" placeholder="URL to your photo">
              </div>
              <button type="submit" class="primary-button"
                style="margin-top: 0.5rem; background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%); border: none;">Update
                Expert Bio</button>
            </form>
          </div>
          {% endif %}
        </div>
      </section>
    </main>

    <!-- Bottom Nav for Mobile -->
    <nav class="bottom-nav">
      <button class="nav-item nav-item--active" onclick="showScreen('screen-home')">üè†</button>
      <button class="nav-item" onclick="showScreen('screen-bookings')">üìÖ</button>
      <button class="nav-item" onclick="showScreen('screen-profile')">üë§</button>
    </nav>
  </div>

  <script>
    function showScreen(screenId) {
      // Hide all screens
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('is-active'));
      // Show target screen
      document.getElementById(screenId).classList.add('is-active');

      // Update sidebar links
      document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('sidebar-link--active'));
      const activeLink = Array.from(document.querySelectorAll('.sidebar-link')).find(l => l.getAttribute('onclick')?.includes(screenId));
      if (activeLink) activeLink.classList.add('sidebar-link--active');

      // Update bottom nav
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('nav-item--active'));
      const activeNavItem = Array.from(document.querySelectorAll('.nav-item')).find(n => n.getAttribute('onclick')?.includes(screenId));
      if (activeNavItem) activeNavItem.classList.add('nav-item--active');
    }

    let currentCategory = 'all';

    function applyFilters() {
      const searchTerm = document.querySelector('.app-header__search-input').value.toLowerCase();
      const selectedLocation = document.getElementById('location-selector').value;
      const cards = document.querySelectorAll('.salon-card');

      let visibleCount = 0;
      cards.forEach(card => {
        const text = card.textContent.toLowerCase();
        const salonLoc = card.getAttribute('data-location').toLowerCase();

        let isMatch = false;

        // CHECK LOCATION MATCH
        const locationMatch = (selectedLocation === 'All Locations' || salonLoc.startsWith(selectedLocation.toLowerCase()));

        // CHECK SEARCH/TERM MATCH
        const searchMatch = (searchTerm === '' || text.includes(searchTerm));

        // CHECK CATEGORY MATCH
        let categoryMatch = true;
        if (currentCategory !== 'all') {
          const categories = card.getAttribute('data-categories') || '';
          categoryMatch = categories.split(',').includes(currentCategory.toLowerCase());
        }

        // FINAL RESULT: Must match Location AND Search AND Category
        isMatch = locationMatch && searchMatch && categoryMatch;

        if (isMatch) {
          card.style.display = 'block';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });

      // Toggle empty state
      if (document.getElementById('empty-state')) {
        document.getElementById('empty-state').style.display = visibleCount === 0 ? 'block' : 'none';
      }
    }

    // Search functionality listener
    document.querySelector('.app-header__search-input').addEventListener('input', applyFilters);

    // Filter by Category
    function filterByCategory(category, btn) {
      document.querySelectorAll('.chip-row .chip').forEach(c => {
        c.classList.remove('chip--active');
        c.classList.remove('blink');
      });

      btn.classList.add('chip--active');
      btn.classList.add('blink');

      // Remove blink class after animation finishes
      setTimeout(() => {
        btn.classList.remove('blink');
      }, 300);

      currentCategory = category;
      applyFilters();
    }

    // Location filtering
    function filterSalonsByLocation() {
      const selectedLocation = document.getElementById('location-selector').value;
      const cityIcon = document.getElementById('city-icon');

      const cityLogos = {
        'Hyderabad': 'üïå', // Charminar
        'Bengaluru': 'üèõÔ∏è', // Vidhana Soudha
        'Mumbai': 'üåâ',    // Gateway / Sea Link
        'Delhi': 'üóº',     // India Gate / Qutub Minar
        'Pune': 'üè∞',      // Shaniwar Wada
        'All Locations': 'üåê'
      };

      cityIcon.innerText = cityLogos[selectedLocation] || 'üìç';
      applyFilters();
    }

    // Auto-show screen based on URL parameter
    window.onload = () => {
      const urlParams = new URLSearchParams(window.location.search);
      const screen = urlParams.get('screen');
      if (screen === 'profile') {
        showScreen('screen-profile');
      }
    };

    // SCISSOR ICON SUGGESTIONS
    const scissorIcon = document.getElementById('scissor-icon');
    const suggestionsBox = document.getElementById('search-suggestions');
    const searchInput = document.querySelector('.app-header__search-input');

    scissorIcon.addEventListener('click', (e) => {
      e.stopPropagation();
      const salonCards = document.querySelectorAll('.salon-card');
      const salonNames = Array.from(salonCards).map(card => card.querySelector('.salon-card__name').innerText);
      const uniqueNames = [...new Set(salonNames)];

      if (suggestionsBox.style.display === 'block') {
        suggestionsBox.style.display = 'none';
        return;
      }

      suggestionsBox.innerHTML = '';
      uniqueNames.forEach(name => {
        const item = document.createElement('div');
        item.innerText = `üíá ${name}`;
        item.style.padding = '0.75rem 1rem';
        item.style.cursor = 'pointer';
        item.style.fontSize = '0.9rem';
        item.style.borderRadius = '8px';
        item.style.transition = 'background 0.2s';

        item.onmouseover = () => item.style.background = '#fdf2ff';
        item.onmouseout = () => item.style.background = 'transparent';

        item.onclick = () => {
          searchInput.value = name;
          suggestionsBox.style.display = 'none';
          applyFilters();
        };
        suggestionsBox.appendChild(item);
      });

      suggestionsBox.style.display = 'block';
    });

    // Close suggestions, notifications and settings when clicking outside
    document.addEventListener('click', (e) => {
      suggestionsBox.style.display = 'none';
      const notifDropdown = document.getElementById('notif-dropdown');
      const settingsDropdown = document.getElementById('settings-dropdown');

      if (notifDropdown && !notifDropdown.contains(e.target) && e.target.id !== 'notif-btn') {
        notifDropdown.style.display = 'none';
      }
      if (settingsDropdown && !settingsDropdown.contains(e.target) && e.target.id !== 'settings-btn') {
        settingsDropdown.style.display = 'none';
      }

      if (typeof micIcon !== 'undefined') micIcon.classList.remove('mic-glow');
    });

    function toggleNotifications(event) {
      event.stopPropagation();
      const dropdown = document.getElementById('notif-dropdown');
      const isVisible = dropdown.style.display === 'block';

      // Close other dropdowns
      suggestionsBox.style.display = 'none';
      const settingsDropdown = document.getElementById('settings-dropdown');
      if (settingsDropdown) settingsDropdown.style.display = 'none';

      dropdown.style.display = isVisible ? 'none' : 'block';
    }

    function toggleSettings(event) {
      event.stopPropagation();
      const dropdown = document.getElementById('settings-dropdown');
      const isVisible = dropdown.style.display === 'block';

      // Close other dropdowns
      suggestionsBox.style.display = 'none';
      const notifDropdown = document.getElementById('notif-dropdown');
      if (notifDropdown) notifDropdown.style.display = 'none';

      dropdown.style.display = isVisible ? 'none' : 'block';
    }

    function handleSetting(setting) {
      if (setting === 'Loyalty Points') {
        showToast("üåü You have 540 Loyalty Points! Earn more by booking services.", "success");
      } else if (setting === 'Refer & Earn') {
        showToast("üí∞ Referral Code: SALON500. Share to earn ‚Çπ500!", "success");
      } else if (setting === 'Language') {
        showToast("üåç Language is set to English (India).", "success");
      } else if (setting === 'Edit Profile') {
        window.location.href = "{{ url_for('login') if not current_user.is_authenticated else '#' }}";
        if ("{{ current_user.is_authenticated }}" === "True") {
          showToast("üë§ Profile settings coming soon!", "info");
        }
      } else {
        showToast(`‚ú® ${setting} feature coming soon!`, "info");
      }
      document.getElementById('settings-dropdown').style.display = 'none';
    }

    function toggleDarkMode() {
      const body = document.body;
      const toggle = document.getElementById('dark-mode-toggle');
      const circle = document.getElementById('dark-mode-circle');

      body.classList.toggle('dark-theme');

      const isDark = body.classList.contains('dark-theme');
      if (isDark) {
        toggle.style.background = '#a855f7';
        toggle.style.borderColor = '#a855f7';
        circle.style.left = '17px';
        showToast("üåì Dark Mode Enabled", "success");
      } else {
        toggle.style.background = '#e2e8f0';
        toggle.style.borderColor = '#cbd5e1';
        circle.style.left = '1px';
        showToast("‚òÄÔ∏è Light Mode Enabled", "success");
      }
    }

    // MIC VOICE RECOGNITION LOGIC
    const micIcon = document.getElementById('mic-icon');
    let recognition;

    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.continuous = false;
      recognition.lang = 'en-US';
      recognition.interimResults = false;

      recognition.onstart = () => {
        micIcon.classList.add('mic-glow');
        searchInput.placeholder = "Listening...";
      };

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        searchInput.value = transcript;
        applyFilters();
        micIcon.classList.remove('mic-glow');
        searchInput.placeholder = "Search for salons, services or style...";
      };

      recognition.onerror = () => {
        micIcon.classList.remove('mic-glow');
        searchInput.placeholder = "Search for salons, services or style...";
      };

      recognition.onend = () => {
        micIcon.classList.remove('mic-glow');
        searchInput.placeholder = "Search for salons, services or style...";
      };
    }

    micIcon.addEventListener('click', (e) => {
      e.stopPropagation();
      if (recognition) {
        if (micIcon.classList.contains('mic-glow')) {
          recognition.stop();
        } else {
          recognition.start();
        }
      } else {
        alert("Voice recognition is not supported in this browser.");
      }
    });

    // INITIALIZE DISPLAY & TOASTS
    window.addEventListener('load', () => {
      applyFilters();

      // SHOW FLASH MESSAGES AS TOASTS
      {% with messages = get_flashed_messages() %}
      {% if messages %}
      {% for message in messages %}
      showToast("{{ message }}", "success");
      {% endfor %}
      {% endif %}
      {% endwith %}
    });

    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast toast--${type}`;
      toast.innerHTML = `<span>${type === 'success' ? '‚úÖ' : '‚ùå'}</span> <span>${message}</span>`;

      container.appendChild(toast);

      // Auto-remove after 4 seconds
      setTimeout(() => {
        toast.style.animation = 'toastFadeOut 0.5s forwards';
        setTimeout(() => toast.remove(), 500);
      }, 4000);
    }
  </script>
</body>

</html>