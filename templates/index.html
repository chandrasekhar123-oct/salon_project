<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Salon Essy ‚Äì Home</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --purple: #a855f7;
      --pink: #ec4899;
      --dark: #0f0a1e;
      --card: rgba(255, 255, 255, 0.04);
      --border: rgba(255, 255, 255, 0.09);
      --text: #e2e8f0;
      --muted: #64748b;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--dark);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(15, 10, 30, 0.85);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
      padding: 14px 20px;
    }

    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .welcome-block h2 {
      font-size: 18px;
      font-weight: 800;
      color: #fff;
    }

    .welcome-block p {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 2px;
    }

    .header-icons {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .icon-btn {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: var(--card);
      border: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text);
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s;
      text-decoration: none;
      position: relative;
    }

    .icon-btn:hover {
      background: rgba(168, 85, 247, 0.15);
      border-color: var(--purple);
    }

    .notif-dot {
      position: absolute;
      top: 6px;
      right: 6px;
      width: 8px;
      height: 8px;
      background: #ef4444;
      border-radius: 50%;
      border: 2px solid var(--dark);
    }

    .avatar-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--purple), var(--pink));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 15px;
      color: #fff;
      cursor: pointer;
      border: 2px solid rgba(168, 85, 247, 0.4);
    }

    /* Search */
    .search-wrap {
      position: relative;
    }

    .search-wrap input {
      width: 100%;
      padding: 12px 16px 12px 44px;
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid var(--border);
      border-radius: 14px;
      color: #fff;
      font-size: 14px;
      font-family: 'Inter', sans-serif;
      outline: none;
      transition: 0.3s;
    }

    .search-wrap input:focus {
      border-color: var(--purple);
      background: rgba(168, 85, 247, 0.08);
    }

    .search-wrap input::placeholder {
      color: var(--muted);
    }

    .search-icon {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
      font-size: 14px;
    }

    .location-picker {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 6px 10px;
      color: #e2e8f0;
      font-size: 13px;
    }

    .location-picker select {
      background: transparent;
      border: none;
      color: inherit;
      font-weight: 700;
      font-size: 13px;
      outline: none;
      cursor: pointer;
    }

    .location-picker option {
      background: #0f0a1e;
      color: #e2e8f0;
    }

    .search-suggestions {
      position: absolute;
      top: 46px;
      left: 0;
      right: 0;
      background: #1a132b;
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      z-index: 150;
      display: none;
      overflow: hidden;
    }

    .search-suggestions .sugg-item {
      padding: 10px 14px;
      font-size: 13px;
      font-weight: 600;
      color: #e5e7eb;
      cursor: pointer;
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }

    .search-suggestions .sugg-item:last-child {
      border-bottom: none;
    }

    .search-suggestions .sugg-item:hover {
      background: rgba(168, 85, 247, 0.12);
      color: #fff;
    }

    /* ‚îÄ‚îÄ MAIN SCROLL AREA ‚îÄ‚îÄ */
    .main {
      padding: 0 20px 90px;
    }

    /* ‚îÄ‚îÄ SECTION TITLE ‚îÄ‚îÄ */
    .section-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 24px 0 14px;
    }

    .section-head h3 {
      font-size: 17px;
      font-weight: 800;
      color: #fff;
    }

    .see-all {
      font-size: 13px;
      color: var(--purple);
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
    }

    /* ‚îÄ‚îÄ CATEGORIES ‚îÄ‚îÄ */
    .categories {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding-bottom: 4px;
      scrollbar-width: none;
    }

    .categories::-webkit-scrollbar {
      display: none;
    }

    .cat-card {
      flex-shrink: 0;
      width: 80px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 14px 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.25s;
    }

    .cat-card:hover,
    .cat-card.active {
      background: rgba(168, 85, 247, 0.15);
      border-color: var(--purple);
      transform: translateY(-3px);
    }

    .cat-icon {
      font-size: 26px;
    }

    .cat-label {
      font-size: 11px;
      font-weight: 700;
      color: #ccc;
      text-align: center;
      line-height: 1.2;
    }

    .cat-card.active .cat-label {
      color: var(--purple);
    }

    /* ‚îÄ‚îÄ OFFERS BANNER ‚îÄ‚îÄ */
    .offers {
      display: flex;
      gap: 14px;
      overflow-x: auto;
      padding-bottom: 4px;
      scrollbar-width: none;
    }

    .offers::-webkit-scrollbar {
      display: none;
    }

    .offer-card {
      flex-shrink: 0;
      min-width: 260px;
      border-radius: 20px;
      padding: 20px;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .offer-card.purple {
      background: linear-gradient(135deg, #7c3aed, #a855f7);
    }

    .offer-card.pink {
      background: linear-gradient(135deg, #be185d, #ec4899);
    }

    .offer-card.teal {
      background: linear-gradient(135deg, #0f766e, #14b8a6);
    }

    .offer-title {
      font-size: 20px;
      font-weight: 900;
      color: #fff;
      margin-bottom: 4px;
    }

    .offer-sub {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 14px;
    }

    .offer-btn {
      display: inline-block;
      background: rgba(255, 255, 255, 0.25);
      color: #fff;
      font-size: 12px;
      font-weight: 700;
      padding: 6px 14px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }

    .offer-emoji {
      position: absolute;
      right: 16px;
      top: 16px;
      font-size: 40px;
      opacity: 0.3;
    }

    /* ‚îÄ‚îÄ SALON CARDS ‚îÄ‚îÄ */
    .salons-list {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .salon-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      overflow: hidden;
      display: flex;
      gap: 0;
      transition: all 0.25s;
    }

    .salon-card:hover {
      border-color: rgba(168, 85, 247, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    }

    .salon-img {
      width: 110px;
      min-height: 110px;
      flex-shrink: 0;
      background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(236, 72, 153, 0.2));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
    }

    .salon-body {
      padding: 14px;
      flex: 1;
    }

    .salon-top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .salon-name {
      font-size: 15px;
      font-weight: 800;
      color: #fff;
    }

    .salon-badge {
      font-size: 10px;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 20px;
    }

    .badge-open {
      background: rgba(16, 185, 129, 0.15);
      color: #10b981;
    }

    .badge-closed {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
    }

    .salon-meta {
      display: flex;
      gap: 12px;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .salon-meta span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .salon-price {
      font-size: 13px;
      font-weight: 700;
      color: var(--purple);
    }

    .salon-actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }

    .btn-book {
      flex: 1;
      padding: 9px;
      border-radius: 10px;
      text-align: center;
      background: linear-gradient(135deg, var(--purple), var(--pink));
      color: #fff;
      font-size: 13px;
      font-weight: 700;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: 0.2s;
    }

    .btn-book:hover {
      opacity: 0.9;
      transform: scale(1.02);
    }

    .btn-fav {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: rgba(236, 72, 153, 0.1);
      border: 1px solid rgba(236, 72, 153, 0.2);
      color: #ec4899;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
    }

    .btn-fav:hover {
      background: rgba(236, 72, 153, 0.2);
    }

    /* ‚îÄ‚îÄ BOOKINGS ‚îÄ‚îÄ */
    .booking-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 16px;
      margin-bottom: 12px;
      transition: 0.2s;
    }

    .booking-card:hover {
      border-color: rgba(168, 85, 247, 0.3);
    }

    .booking-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .booking-service {
      font-size: 15px;
      font-weight: 700;
      color: #fff;
    }

    .status-badge {
      font-size: 11px;
      font-weight: 700;
      padding: 4px 10px;
      border-radius: 20px;
    }

    .status-confirmed {
      background: rgba(16, 185, 129, 0.15);
      color: #10b981;
    }

    .status-pending {
      background: rgba(251, 191, 36, 0.15);
      color: #fbbf24;
    }

    .status-cancelled {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
    }

    .status-completed {
      background: rgba(99, 102, 241, 0.15);
      color: #818cf8;
    }

    .booking-salon {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .booking-meta {
      display: flex;
      gap: 16px;
      font-size: 12px;
      color: var(--muted);
    }

    .booking-meta span {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .booking-price {
      font-size: 15px;
      font-weight: 800;
      color: var(--purple);
      margin-top: 8px;
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
    }

    .empty-state .empty-icon {
      font-size: 48px;
      margin-bottom: 12px;
      opacity: 0.4;
    }

    .empty-state p {
      font-size: 14px;
    }

    /* ‚îÄ‚îÄ PROFILE PANEL ‚îÄ‚îÄ */
    .profile-panel {
      background: linear-gradient(145deg, rgba(168, 85, 247, 0.1), rgba(236, 72, 153, 0.05));
      border: 1px solid rgba(168, 85, 247, 0.2);
      border-radius: 24px;
      padding: 28px;
      text-align: center;
      margin-bottom: 20px;
    }

    .profile-avatar-lg {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--purple), var(--pink));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      font-weight: 900;
      color: #fff;
      margin: 0 auto 14px;
      border: 3px solid rgba(168, 85, 247, 0.5);
    }

    .profile-name {
      font-size: 20px;
      font-weight: 800;
      color: #fff;
      margin-bottom: 4px;
    }

    .profile-email {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 16px;
    }


    .profile-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .pstat {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 14px;
    }

    .pstat-num {
      font-size: 22px;
      font-weight: 900;
      color: var(--purple);
    }

    .pstat-label {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    /* ‚îÄ‚îÄ BOTTOM NAV ‚îÄ‚îÄ */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(15, 10, 30, 0.95);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--border);
      display: flex;
      padding: 8px 0;
      z-index: 200;
    }

    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 4px;
      cursor: pointer;
      border: none;
      background: none;
      color: var(--muted);
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      transition: 0.2s;
    }

    .nav-item i {
      font-size: 20px;
      transition: 0.2s;
    }

    .nav-item.active {
      color: var(--purple);
    }

    .nav-item.active i {
      transform: scale(1.1);
    }

    .nav-item:hover {
      color: var(--purple);
    }

    /* ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ */
    .screen {
      display: none;
    }

    .screen.is-active {
      display: block;
    }

    /* ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-content {
      background: #1e1030;
      border: 1px solid rgba(168, 85, 247, 0.4);
      border-radius: 24px;
      width: 100%;
      max-width: 400px;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      animation: modalFadeIn 0.3s ease-out forwards;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-header h3 {
      font-size: 18px;
      color: #fff;
    }

    .modal-close {
      background: transparent;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 18px;
      padding: 4px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      font-size: 12px;
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .form-group input {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: #fff;
      font-family: 'Inter', sans-serif;
      outline: none;
      transition: 0.2s;
    }

    .form-group input:focus {
      border-color: var(--purple);
      background: rgba(168, 85, 247, 0.05);
    }

    .btn-primary {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--purple), var(--pink));
      border: none;
      border-radius: 14px;
      color: #fff;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: 0.2s;
    }

    .btn-primary:active {
      transform: scale(0.98);
    }

    /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
    .toast-container {
      position: fixed;
      top: 80px;
      right: 16px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .toast {
      background: #1e1030;
      border: 1px solid rgba(168, 85, 247, 0.4);
      color: #fff;
      padding: 12px 18px;
      border-radius: 14px;
      font-size: 13px;
      font-weight: 600;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(40px)
      }

      to {
        opacity: 1;
        transform: translateX(0)
      }
    }

    /* ‚îÄ‚îÄ SIDEBAR (Desktop) ‚îÄ‚îÄ */
    @media(min-width:768px) {
      .app-wrapper {
        display: grid;
        grid-template-columns: 240px 1fr;
        min-height: 100vh;
      }

      .desktop-sidebar {
        background: rgba(255, 255, 255, 0.02);
        border-right: 1px solid var(--border);
        padding: 28px 16px;
        position: sticky;
        top: 0;
        height: 100vh;
        overflow-y: auto;
      }

      .desktop-sidebar .logo {
        font-size: 22px;
        font-weight: 900;
        margin-bottom: 32px;
        padding: 0 10px;
        background: linear-gradient(135deg, var(--purple), var(--pink));
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .sidebar-link {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 14px;
        border-radius: 12px;
        color: var(--muted);
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: 0.2s;
        text-decoration: none;
        margin-bottom: 4px;
      }

      .sidebar-link:hover,
      .sidebar-link.active {
        background: rgba(168, 85, 247, 0.12);
        color: var(--purple);
      }

      .sidebar-link i {
        font-size: 16px;
        width: 20px;
      }

      .bottom-nav {
        display: none;
      }

      .main {
        padding: 0 28px 40px;
      }
    }

    /* ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ */
    ::-webkit-scrollbar {
      width: 4px;
      height: 4px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(168, 85, 247, 0.3);
      border-radius: 10px;
    }

    /* Flash */
    .flash-msg {
      background: rgba(168, 85, 247, 0.15);
      border: 1px solid rgba(168, 85, 247, 0.3);
      border-radius: 12px;
      padding: 12px 16px;
      font-size: 13px;
      color: #c4b5fd;
      margin: 12px 0;
    }

    /* Notification Dropdown */
    .dropdown {
      display: none;
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      width: 300px;
      background: #1a1030;
      border: 1px solid var(--border);
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      z-index: 500;
      overflow: hidden;
    }

    .dropdown.open {
      display: block;
      animation: slideIn 0.25s ease;
    }

    .dropdown-header {
      padding: 16px;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
      font-weight: 700;
    }

    .notif-item {
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      display: flex;
      gap: 12px;
      cursor: pointer;
      transition: 0.2s;
    }

    .notif-item:hover {
      background: rgba(168, 85, 247, 0.08);
    }

    .notif-icon-wrap {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: rgba(168, 85, 247, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-size: 18px;
    }

    .notif-text p {
      font-size: 13px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 2px;
    }

    .notif-text span {
      font-size: 11px;
      color: var(--muted);
    }
  </style>
</head>

<body>

  <div class="toast-container" id="toastContainer"></div>

  <div class="app-wrapper">

    <!-- ‚ïê‚ïê‚ïê DESKTOP SIDEBAR ‚ïê‚ïê‚ïê -->
    <aside class="desktop-sidebar" id="desktopSidebar">
      <div class="logo">‚úÇÔ∏è Salon Essy</div>
      <a class="sidebar-link active" onclick="switchScreen('home',this)"><i class="fas fa-home"></i> Home</a>
      <a class="sidebar-link" onclick="switchScreen('search',this)"><i class="fas fa-search"></i> Search</a>
      <a class="sidebar-link" onclick="switchScreen('bookings',this)"><i class="fas fa-calendar-check"></i> Bookings</a>
      <a class="sidebar-link" onclick="switchScreen('favorites',this)"><i class="fas fa-heart"></i> Favorites</a>
      <a class="sidebar-link" onclick="switchScreen('profile',this)"><i class="fas fa-user"></i> Profile</a>
      <a class="sidebar-link" data-target="settings" onclick="switchScreen('settings',this)"><i class="fas fa-cog"></i> Settings</a>
      {% if current_user.role == 'salon_owner' %}
      <a class="sidebar-link" href="{{ url_for('owner_dashboard') }}"
        style="color:#a855f7; margin-top:12px; border:1px dashed rgba(168,85,247,0.3);"><i class="fas fa-store"></i>
        Owner Panel</a>
      {% endif %}
      {% if current_user.role == 'worker' %}
      <a class="sidebar-link" href="{{ url_for('worker_dashboard') }}"
        style="color:#ec4899; margin-top:12px; border:1px dashed rgba(236,72,153,0.3);"><i class="fas fa-briefcase"></i>
        Worker Panel</a>
      {% endif %}
      <div style="margin-top:auto; padding-top:20px; border-top:1px solid var(--border); margin-top:40px;">
        <a class="sidebar-link" href="{{ url_for('logout') }}" style="color:#ef4444;"><i
            class="fas fa-sign-out-alt"></i> Logout</a>
      </div>
    </aside>

    <!-- ‚ïê‚ïê‚ïê RIGHT CONTENT ‚ïê‚ïê‚ïê -->
    <div style="flex:1; min-width:0;">

      <!-- ‚îÄ‚îÄ STICKY HEADER ‚îÄ‚îÄ -->
      <div class="header">
        <div class="header-top">
          <div class="welcome-block">
            <h2>üëã Welcome, {{ current_user.name.split()[0] if current_user.is_authenticated else 'Guest' }}</h2>
            <p onclick="document.getElementById('locationFilter').scrollIntoView({behavior:'smooth', block:'center'}); document.getElementById('locationFilter').focus();"
              style="cursor:pointer; display:inline-flex; align-items:center; gap:6px; padding:6px 10px; background:rgba(255,255,255,0.05); border-radius:12px; transition:0.2s; margin-top:4px;"
              onmouseover="this.style.background='rgba(255,255,255,0.1)'"
              onmouseout="this.style.background='rgba(255,255,255,0.05)'">
              <i class="fas fa-map-marker-alt" style="color:var(--purple);"></i>
              <span id="locationDisplay">Hyderabad, India</span>
              <i class="fas fa-chevron-down" style="font-size:10px; color:var(--muted); margin-left:4px;"></i>
            </p>
          </div>
          <div class="header-icons">
            <div class="location-picker">
              <i class="fas fa-map-marker-alt" style="color:var(--purple);"></i>
              <select id="locationPicker" onchange="syncLocation(this.value)">
                <option value="">All Cities</option>
                <option value="Hyderabad">Hyderabad</option>
                <option value="Bengaluru">Bengaluru</option>
                <option value="Mumbai">Mumbai</option>
                <option value="Delhi">Delhi</option>
                <option value="Pune">Pune</option>
              </select>
            </div>
            <!-- Notification -->
            <div style="position:relative;">
              <div class="icon-btn" id="notifBtn" onclick="toggleDropdown('notifDrop')">
                <i class="fas fa-bell"></i>
                <div class="notif-dot"></div>
              </div>
              <div class="dropdown" id="notifDrop">
                <div class="dropdown-header">üîî Notifications</div>
                <div class="notif-item" onclick="switchScreen('bookings', document.getElementById('nav-bookings'))">
                  <div class="notif-icon-wrap">üßñ‚Äç‚ôÄÔ∏è</div>
                  <div class="notif-text">
                    <p>Booking Confirmed!</p><span>Your appointment is set for tomorrow 10 AM</span>
                  </div>
                </div>
                <div class="notif-item" onclick="window.location.href='/salon/1'">
                  <div class="notif-icon-wrap">üî•</div>
                  <div class="notif-text">
                    <p>Special Spa Offer</p><span>20% OFF on Full Body Massage this weekend</span>
                  </div>
                </div>
                <div class="notif-item" onclick="switchScreen('bookings', document.getElementById('nav-bookings'))">
                  <div class="notif-icon-wrap">‚úÖ</div>
                  <div class="notif-text">
                    <p>Payment Successful</p><span>Invoice #SER-9802 for ‚Çπ1,200 paid</span>
                  </div>
                </div>
              </div>
            </div>
            <!-- Profile -->
            <div class="avatar-btn" onclick="switchScreen('profile', null)">
              {{ current_user.name[:2]|upper if current_user.is_authenticated else 'üë§' }}
            </div>
          </div>
        </div>
        <!-- Search -->
        <div class="search-wrap">
          <i class="fas fa-search search-icon"></i>
          <input type="text" id="searchInput" placeholder="Search salons, services, styles..."
            oninput="filterSalons()" />
          <div id="searchSuggestions" class="search-suggestions"></div>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ -->
      <div class="main">

        {% with messages = get_flashed_messages() %}
        {% if messages %}{% for m in messages %}<div class="flash-msg">{{ m }}</div>{% endfor %}{% endif %}
        {% endwith %}

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HOME SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="screen is-active" id="screen-home">

          <!-- CATEGORIES -->
          <div class="section-head">
            <h3>Browse Categories</h3>
            <span class="see-all">View All</span>
          </div>
          <div class="categories" id="categoryRow">
            <div class="cat-card active" onclick="filterCat('',this)">
              <div class="cat-icon">üõçÔ∏è</div>
              <div class="cat-label">All Services</div>
            </div>
            <div class="cat-card" onclick="filterCat('Hair',this)">
              <div class="cat-icon">‚úÇÔ∏è</div>
              <div class="cat-label">Hair Cut</div>
            </div>
            <div class="cat-card" onclick="filterCat('Beauty Parlour',this)">
              <div class="cat-icon">üíÑ</div>
              <div class="cat-label">Beauty Parlour</div>
            </div>
            <div class="cat-card" onclick="filterCat('Spa',this)">
              <div class="cat-icon">üßñ</div>
              <div class="cat-label">Spa</div>
            </div>
          </div>

          <!-- OFFERS -->
          <div class="section-head">
            <h3>üéÅ Offers & Deals</h3>
          </div>
          <div class="offers">
            <div class="offer-card purple">
              <div class="offer-title">20% OFF</div>
              <div class="offer-sub">On your first booking today!</div>
              <div class="offer-btn" onclick="window.location.href='/salon/1'">Grab Deal</div>
              <div class="offer-emoji">‚úÇÔ∏è</div>
            </div>
            <div class="offer-card pink">
              <div class="offer-title">Free Beard Trim</div>
              <div class="offer-sub">With any Haircut booking</div>
              <div class="offer-btn" onclick="window.location.href='/salon/1'">Book Now</div>
              <div class="offer-emoji">üßî</div>
            </div>
            <div class="offer-card teal">
              <div class="offer-title">Spa Combo</div>
              <div class="offer-sub">2 services for price of 1</div>
              <div class="offer-btn" onclick="window.location.href='/salon/1'">Explore</div>
              <div class="offer-emoji">üßñ</div>
            </div>
          </div>

          <!-- LOCATION FILTER (hidden; use header picker instead) -->
          <div class="section-head" style="display:none;">
            <h3>üìç Nearby Salons</h3>
            <select id="locationFilter" onchange="filterSalons()"
              style="background:rgba(255,255,255,0.06); border:1px solid var(--border); color:#fff; border-radius:10px; padding:6px 10px; font-size:12px; font-family:'Inter',sans-serif; outline:none; cursor:pointer;-webkit-appearance: none; -moz-appearance: none; appearance: none;">
              <option value="" style="background:var(--card); color:#fff; padding:10px;">All Cities</option>
              <option value="Hyderabad" selected style="background:var(--card); color:#fff; padding:10px;">Hyderabad
              </option>
              <option value="Bengaluru" style="background:var(--card); color:#fff; padding:10px;">Bengaluru</option>
              <option value="Mumbai" style="background:var(--card); color:#fff; padding:10px;">Mumbai</option>
              <option value="Delhi" style="background:var(--card); color:#fff; padding:10px;">Delhi</option>
              <option value="Pune" style="background:var(--card); color:#fff; padding:10px;">Pune</option>
            </select>
          </div>

          <!-- SALON CARDS -->
          <div class="salons-list" id="salonsList">
            {% for salon in salons %}
            <div class="salon-card" data-location="{{ salon.location }}"
              data-cats="{{ salon.services|map(attribute='category')|unique|join(',')|lower }}"
              data-name="{{ salon.name|lower }}"
              data-price="{{ salon.services|map(attribute='price')|min if salon.services else 999 }}">
              <div class="salon-img">
                {% if "Glow" in salon.name %}‚ú®
                {% elif "Urban" in salon.name %}üèôÔ∏è
                {% elif "Royal" in salon.name %}üëë
                {% elif "Mirror" in salon.name %}ü™û
                {% elif "Barber" in salon.name %}üíà
                {% elif "Luxury" in salon.name %}üíé
                {% elif "Budget" in salon.name %}üí∞
                {% elif "Spa" in salon.name %}üßñ
                {% elif "Silicon" in salon.name %}üíª
                {% elif "Garden" in salon.name %}üåø
                {% elif "Bollywood" in salon.name %}üé¨
                {% elif "Elite" in salon.name %}‚≠ê
                {% else %}üíá{% endif %}
              </div>
              <div class="salon-body">
                <div class="salon-top">
                  <div class="salon-name">{{ salon.name }}</div>
                  <span class="salon-badge {{ 'badge-open' if salon.is_open else 'badge-closed' }}">
                    {{ 'üü¢ Open' if salon.is_open else 'üî¥ Closed' }}
                  </span>
                </div>
                <div class="salon-meta">
                  <span><i class="fas fa-star" style="color:#fbbf24;"></i> {{ salon.rating }}</span>
                  <span><i class="fas fa-map-marker-alt" style="color:var(--purple);"></i> {{
                    salon.location.split(',')[0] }}</span>
                  <span><i class="fas fa-walking" style="color:#10b981;"></i> ~1.2 km</span>
                </div>
                <div class="salon-price">
                  ‚Çπ{{ salon.services|map(attribute='price')|min|int if salon.services else '‚Äì' }} onwards
                </div>
                <div class="salon-actions">
                  <a href="{{ url_for('salon_details', salon_id=salon.id) }}" class="btn-book">
                    <i class="fas fa-calendar-plus"></i> Book Now
                  </a>
                  <div class="btn-fav" onclick="toggleFav(this)"><i class="far fa-heart"></i></div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>

          <!-- EMPTY STATE -->
          <div id="emptyState" style="display:none;" class="empty-state">
            <div class="empty-icon">üîç</div>
            <p>No salons found matching your search.</p>
          </div>

        </div><!-- /screen-home -->

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SEARCH SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="screen" id="screen-search">
          <div class="section-head">
            <h3>üîç Search Results</h3>
          </div>
          <div class="search-wrap" style="margin-bottom:16px;">
            <i class="fas fa-search search-icon"></i>
            <input type="text" placeholder="Search salons, services..." oninput="filterSalons()" id="searchInput2"
              style="width:100%; padding:12px 16px 12px 44px; background:rgba(255,255,255,0.06); border:1px solid var(--border); border-radius:14px; color:#fff; font-size:14px; font-family:'Inter',sans-serif; outline:none;" />
          </div>
          <p style="color:var(--muted); font-size:13px; margin-bottom:16px;">Try: "Haircut", "Spa", "Kolkata"...</p>
          <div class="salons-list" id="searchResults">
            {% for salon in salons %}
            <div class="salon-card s-result" data-location="{{ salon.location }}" data-name="{{ salon.name|lower }}"
              data-cats="{{ salon.services|map(attribute='category')|unique|join(',')|lower }}">
              <div class="salon-img">üíá</div>
              <div class="salon-body">
                <div class="salon-top">
                  <div class="salon-name">{{ salon.name }}</div>
                  <span class="salon-badge badge-open">üü¢ Open</span>
                </div>
                <div class="salon-meta">
                  <span><i class="fas fa-star" style="color:#fbbf24;"></i> {{ salon.rating }}</span>
                  <span><i class="fas fa-map-marker-alt" style="color:var(--purple);"></i> {{ salon.location }}</span>
                </div>
                <a href="{{ url_for('salon_details', salon_id=salon.id) }}" class="btn-book"
                  style="display:block; text-align:center; margin-top:10px;">Book Now</a>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BOOKINGS SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="screen" id="screen-bookings">
          <div class="section-head">
            <h3>üìÖ My Bookings</h3>
          </div>

          <!-- TABS -->
          <div style="display:flex; gap:8px; margin-bottom:20px; overflow-x:auto; padding-bottom:4px;">
            <button class="tab-btn active" onclick="switchTab('upcoming',this)"
              style="flex-shrink:0; padding:8px 18px; border-radius:20px; border:none; background:rgba(168,85,247,0.2); color:var(--purple); font-weight:700; font-size:13px; cursor:pointer;">Upcoming</button>
            <button class="tab-btn" onclick="switchTab('completed',this)"
              style="flex-shrink:0; padding:8px 18px; border-radius:20px; border:1px solid var(--border); background:transparent; color:var(--muted); font-size:13px; font-weight:600; cursor:pointer;">Completed</button>
            <button class="tab-btn" onclick="switchTab('cancelled',this)"
              style="flex-shrink:0; padding:8px 18px; border-radius:20px; border:1px solid var(--border); background:transparent; color:var(--muted); font-size:13px; font-weight:600; cursor:pointer;">Cancelled</button>
          </div>

          <!-- UPCOMING -->
          <div id="tab-upcoming">
            {% set upcoming = user_bookings|selectattr('status','in',['Pending','Confirmed','Accepted'])|list %}
            {% if upcoming %}
            {% for b in upcoming %}
            <div class="booking-card">
              <div class="booking-top">
                <div class="booking-service">{{ b.service.name }}</div>
                <span
                  class="status-badge {{ 'status-confirmed' if b.status=='Confirmed' or b.status=='Accepted' else 'status-pending' }}">
                  {{ 'üü¢ ' if b.status in ['Confirmed','Accepted'] else 'üü° ' }}{{ b.status }}
                </span>
              </div>
              <div class="booking-salon"><i class="fas fa-store" style="color:var(--purple);"></i> {{ b.salon.name }}
              </div>
              <div class="booking-meta">
                <span><i class="fas fa-calendar"></i> {{ b.date }}</span>
                <span><i class="fas fa-clock"></i> {{ b.time }}</span>
              </div>
              <div class="booking-price">‚Çπ{{ b.service.price|int }}</div>
            </div>
            {% endfor %}
            {% else %}
            <div class="empty-state">
              <div class="empty-icon">üìÖ</div>
              <p>No upcoming bookings.<br><a onclick="switchScreen('home',null)"
                  style="color:var(--purple); cursor:pointer;">Book a salon now ‚Üí</a></p>
            </div>
            {% endif %}
          </div>

          <!-- COMPLETED -->
          <div id="tab-completed" style="display:none;">
            {% set done = user_bookings|selectattr('status','equalto','Completed')|list %}
            {% if done %}
            {% for b in done %}
            <div class="booking-card">
              <div class="booking-top">
                <div class="booking-service">{{ b.service.name }}</div>
                <span class="status-badge status-completed">‚úÖ Completed</span>
              </div>
              <div class="booking-salon"><i class="fas fa-store" style="color:var(--purple);"></i> {{ b.salon.name }}
              </div>
              <div class="booking-meta"><span><i class="fas fa-calendar"></i> {{ b.date }}</span></div>
              <div class="booking-price">‚Çπ{{ b.service.price|int }}</div>
            </div>
            {% endfor %}
            {% else %}<div class="empty-state">
              <div class="empty-icon">‚úÖ</div>
              <p>No completed bookings yet.</p>
            </div>{% endif %}
          </div>

          <!-- CANCELLED -->
          <div id="tab-cancelled" style="display:none;">
            {% set cancelled = user_bookings|selectattr('status','equalto','Cancelled')|list %}
            {% if cancelled %}
            {% for b in cancelled %}
            <div class="booking-card">
              <div class="booking-top">
                <div class="booking-service">{{ b.service.name }}</div>
                <span class="status-badge status-cancelled">üî¥ Cancelled</span>
              </div>
              <div class="booking-salon"><i class="fas fa-store" style="color:var(--purple);"></i> {{ b.salon.name }}
              </div>
              <div class="booking-price">‚Çπ{{ b.service.price|int }}</div>
            </div>
            {% endfor %}
            {% else %}<div class="empty-state">
              <div class="empty-icon">‚ùå</div>
              <p>No cancelled bookings.</p>
            </div>{% endif %}
          </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FAVORITES SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="screen" id="screen-favorites">
          <div class="section-head">
            <h3>‚ù§Ô∏è Saved Salons</h3>
          </div>
          <div class="empty-state" id="favEmpty">
            <div class="empty-icon">üíî</div>
            <p>No favorites yet.<br>Tap the ‚ù§Ô∏è on any salon to save it!</p>
          </div>
          <div id="favList"></div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PROFILE SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="screen" id="screen-profile">
          <div id="profileBackRow" style="display:none; align-items:center; gap:10px; margin-bottom:12px;">
            <button
              style="background:rgba(255,255,255,0.06); border:1px solid var(--border); color:#fff; width:38px; height:38px; border-radius:12px; cursor:pointer;"
              onclick="returnFromProfileToSettings()">
              <i class="fas fa-arrow-left"></i>
            </button>
            <span style="color:#fff; font-weight:800; font-size:14px;">Back to Settings</span>
          </div>
          <div class="profile-panel">
            <div class="profile-avatar-lg" id="profileAvatar">
              <span id="profileAvatarInitials">{{ current_user.name[:2]|upper if current_user.is_authenticated else 'üë§' }}</span>
              <img id="profileAvatarImg" src="" alt="Profile photo" style="display:none; width:100%; height:100%; border-radius:50%; object-fit:cover;">
              <label for="profilePhotoInput"
                style="position:absolute; right:-6px; bottom:-6px; width:32px; height:32px; background:#a855f7; color:#fff; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; border:3px solid rgba(15,10,30,0.9); box-shadow:0 6px 18px rgba(0,0,0,0.3); font-size:14px;">
                <i class="fas fa-camera"></i>
              </label>
              <input type="file" accept="image/*" id="profilePhotoInput" style="display:none;">
            </div>
            <div class="profile-name">{{ current_user.name if current_user.is_authenticated else 'Guest' }}</div>
            <div class="profile-email">{{ current_user.email if current_user.is_authenticated else '' }}</div>
            <div class="profile-stats">
              <div class="pstat">
                <div class="pstat-num">{{ user_bookings|length }}</div>
                <div class="pstat-label">Total Bookings</div>
              </div>
              <div class="pstat">
                <div class="pstat-num">‚Çπ0</div>
                <div class="pstat-label">Wallet Balance</div>
              </div>
            </div>
          </div>

          <div id="profileList" style="display:flex; flex-direction:column; gap:10px;">
            {% if current_user.role == 'salon_owner' %}
            <a href="{{ url_for('owner_dashboard') }}"
              style="display:flex; align-items:center; gap:14px; padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px; text-decoration:none; color:#fff; font-weight:700;">
              <span style="font-size:22px;">üè¢</span> Owner Dashboard
              <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--muted);"></i>
            </a>
            {% endif %}
            {% if current_user.role == 'worker' %}
            <a href="{{ url_for('worker_dashboard') }}"
              style="display:flex; align-items:center; gap:14px; padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px; text-decoration:none; color:#fff; font-weight:700;">
              <span style="font-size:22px;">üëî</span> Worker Dashboard
              <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--muted);"></i>
            </a>
            {% endif %}
            <div
              style="display:flex; align-items:center; gap:14px; padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px; cursor:pointer;"
              onclick="showProfileDetail('loyalty')">
              <span style="font-size:22px;">üåü</span> <span style="font-weight:700;">Loyalty Points</span>
              <span style="margin-left:auto; color:var(--purple); font-weight:800;">540 pts</span>
            </div>
            <div
              style="display:flex; align-items:center; gap:14px; padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px; cursor:pointer;"
              onclick="showProfileDetail('refer')">
              <span style="font-size:22px;">üí∞</span> <span style="font-weight:700;">Refer & Earn</span>
              <span style="margin-left:auto; color:#10b981; font-weight:700;">‚Çπ500</span>
            </div>
            <a href="{{ url_for('logout') }}"
              style="display:flex; align-items:center; gap:14px; padding:16px; background:rgba(239,68,68,0.08); border:1px solid rgba(239,68,68,0.2); border-radius:16px; text-decoration:none; color:#ef4444; font-weight:700; margin-top:8px;">
              <span style="font-size:22px;">üö™</span> Logout
            </a>
          </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETTINGS SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="screen" id="screen-settings">
          <div class="section-head" style="display:flex; align-items:center; gap:10px;">
            <button id="settingsBackBtn"
              style="background:rgba(255,255,255,0.06); border:1px solid var(--border); color:#fff; width:38px; height:38px; border-radius:12px; cursor:pointer; visibility:hidden;"
              onclick="switchScreen('home', document.querySelector('.sidebar-link'))">
              <i class="fas fa-arrow-left"></i>
            </button>
            <h3 style="margin:0;">‚öôÔ∏è Settings</h3>
          </div>

          <!-- Profile detail pane -->
          <div id="profileDetail" style="display:none; background:var(--card); border:1px solid var(--border); border-radius:16px; padding:16px; margin-top:12px;">
            <div class="profile-detail-header" style="display:flex; align-items:center; gap:12px; margin-bottom:16px;">
              <button
                style="background:rgba(255,255,255,0.08); border:1px solid var(--border); color:#fff; width:42px; height:42px; border-radius:12px; cursor:pointer; display:flex; align-items:center; justify-content:center;"
                onclick="closeProfileDetail()">
                <i class="fas fa-arrow-left"></i>
              </button>
              <h4 id="profileDetailTitle" style="margin:0; color:#fff; font-size:17px; font-weight:800;">Detail</h4>
            </div>
            <div id="profileDetailBody" style="color:#cbd5e1; font-size:14px; line-height:1.6;"></div>
          </div>
          <div style="display:flex; flex-direction:column; gap:10px;">

            <!-- Account Info -->
            <div style="padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px;">
              <div
                style="font-size:12px; color:var(--muted); margin-bottom:12px; text-transform:uppercase; letter-spacing:1px; font-weight:800;">
                Account Settings</div>

              <div
                style="display:flex; align-items:center; gap:14px; padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.05); cursor:pointer;"
                onclick="openProfileFromSettings()">
                <div
                  style="width:36px; height:36px; border-radius:10px; background:rgba(168,85,247,0.15); display:flex; align-items:center; justify-content:center; color:#a855f7;">
                  <i class="fas fa-user-edit"></i>
                </div>
                <div>
                  <div style="font-size:15px; font-weight:700; color:#fff;">Edit Profile</div>
                  <div style="font-size:12px; color:var(--muted);">Update your personal details</div>
                </div>
                <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--muted);"></i>
              </div>

              <div style="display:flex; align-items:center; gap:14px; padding:12px 0; cursor:pointer;"
                onclick="openPasswordModal(); showSettingsBack(true);">
                <div
                  style="width:36px; height:36px; border-radius:10px; background:rgba(236,72,153,0.15); display:flex; align-items:center; justify-content:center; color:#ec4899;">
                  <i class="fas fa-lock"></i>
                </div>
                <div>
                  <div style="font-size:15px; font-weight:700; color:#fff;">Change Password</div>
                  <div style="font-size:12px; color:var(--muted);">Update your security credentials</div>
                </div>
                <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--muted);"></i>
              </div>
            </div>

            <!-- App Preferences -->
            <div
              style="padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px; margin-top:8px;">
              <div
                style="font-size:12px; color:var(--muted); margin-bottom:12px; text-transform:uppercase; letter-spacing:1px; font-weight:800;">
                App Preferences</div>

              <div
                style="display:flex; align-items:center; gap:14px; padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.05);">
                <div
                  style="width:36px; height:36px; border-radius:10px; background:rgba(16,185,129,0.15); display:flex; align-items:center; justify-content:center; color:#10b981;">
                  <i class="fas fa-bell"></i>
                </div>
                <div>
                  <div style="font-size:15px; font-weight:700; color:#fff;">Push Notifications</div>
                  <div style="font-size:12px; color:var(--muted);">Updates on your bookings</div>
                </div>
                <div style="margin-left:auto;">
                  <label style="position:relative; display:inline-block; width:44px; height:24px;">
                    <input type="checkbox" checked
                      onchange="showToast(this.checked ? 'Notifications enabled' : 'Notifications disabled')"
                      style="opacity:0; width:0; height:0;">
                    <span
                      style="position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#a855f7; transition:.4s; border-radius:34px;">
                      <span
                        style="position:absolute; content:''; height:18px; width:18px; left:23px; bottom:3px; background-color:white; transition:.4s; border-radius:50%;"></span>
                    </span>
                  </label>
                </div>
              </div>

              <div style="display:flex; align-items:center; gap:14px; padding:12px 0;">
                <div
                  style="width:36px; height:36px; border-radius:10px; background:rgba(245,158,11,0.15); display:flex; align-items:center; justify-content:center; color:#f59e0b;">
                  <i class="fas fa-moon"></i>
                </div>
                <div>
                  <div style="font-size:15px; font-weight:700; color:#fff;">Dark Mode</div>
                  <div style="font-size:12px; color:var(--muted);">Toggle app theme</div>
                </div>
                <div style="margin-left:auto;">
                  <label style="position:relative; display:inline-block; width:44px; height:24px;">
                    <input type="checkbox" id="themeToggle" checked onchange="toggleTheme()"
                      style="opacity:0; width:0; height:0;">
                    <span
                      style="position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#a855f7; transition:.4s; border-radius:34px;">
                      <span id="themeKnob"
                        style="position:absolute; content:''; height:18px; width:18px; left:23px; bottom:3px; background-color:white; transition:.4s; border-radius:50%;"></span>
                    </span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Support -->
            <div
              style="padding:16px; background:var(--card); border:1px solid var(--border); border-radius:16px; margin-top:8px;">
              <div
                style="font-size:12px; color:var(--muted); margin-bottom:12px; text-transform:uppercase; letter-spacing:1px; font-weight:800;">
                Support & About</div>

              <div
                style="display:flex; align-items:center; gap:14px; padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.05); cursor:pointer;"
                onclick="openHelpModal()">
                <div
                  style="width:36px; height:36px; border-radius:10px; background:rgba(59,130,246,0.15); display:flex; align-items:center; justify-content:center; color:#3b82f6;">
                  <i class="fas fa-question-circle"></i>
                </div>
                <div>
                  <div style="font-size:15px; font-weight:700; color:#fff;">Help & Support</div>
                  <div style="font-size:12px; color:var(--muted);">FAQs and contact info</div>
                </div>
                <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--muted);"></i>
              </div>

              <div style="display:flex; align-items:center; gap:14px; padding:12px 0; cursor:pointer;"
                onclick="openAboutModal()">
                <div
                  style="width:36px; height:36px; border-radius:10px; background:rgba(99,102,241,0.15); display:flex; align-items:center; justify-content:center; color:#6366f1;">
                  <i class="fas fa-info-circle"></i>
                </div>
                <div>
                  <div style="font-size:15px; font-weight:700; color:#fff;">About Salon Essy</div>
                  <div style="font-size:12px; color:var(--muted);">Privacy policy and terms</div>
                </div>
                <i class="fas fa-chevron-right" style="margin-left:auto; color:var(--muted);"></i>
              </div>
            </div>

          </div>
        </div>

      </div><!-- /main -->
    </div><!-- /right content -->
  </div><!-- /app-wrapper -->

  <!-- ‚ïê‚ïê PASSWORD MODAL ‚ïê‚ïê -->
  <div class="modal-overlay" id="passwordModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Update Password</h3>
        <button class="modal-close" onclick="closePasswordModal()"><i class="fas fa-times"></i></button>
      </div>
      <form onsubmit="handlePasswordUpdate(event)">
        <div class="form-group">
          <label>Current Password</label>
          <input type="password" required placeholder="Enter current password">
        </div>
        <div class="form-group">
          <label>New Password</label>
          <input type="password" required placeholder="Enter new password">
        </div>
        <div class="form-group" style="margin-bottom:24px;">
          <label>Confirm New Password</label>
          <input type="password" required placeholder="Confirm new password">
        </div>
        <button type="submit" class="btn-primary">Update Password</button>
      </form>
    </div>
  </div>

  <!-- ‚ïê‚ïê HELP MODAL ‚ïê‚ïê -->
  <div class="modal-overlay" id="helpModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Help & Support</h3>
        <button class="modal-close" onclick="closeHelpModal()"><i class="fas fa-times"></i></button>
      </div>
      <div style="color:var(--muted); font-size:14px; line-height:1.6; margin-bottom:20px;">
        <p style="margin-bottom:12px">Need assistance with your booking? Our support team is here to help.</p>
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px; color:#fff;">
          <i class="fas fa-envelope" style="color:var(--purple); width:20px;"></i> support@salonessy.app
        </div>
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px; color:#fff;">
          <i class="fas fa-phone-alt" style="color:var(--purple); width:20px;"></i> +91 98765 43210
        </div>
        <div style="display:flex; align-items:center; gap:10px; color:#fff;">
          <i class="fas fa-clock" style="color:var(--purple); width:20px;"></i> Mon-Sat, 9 AM - 8 PM
        </div>
      </div>
      <button class="btn-primary" onclick="closeHelpModal()">Got it</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê ABOUT MODAL ‚ïê‚ïê -->
  <div class="modal-overlay" id="aboutModal">
    <div class="modal-content" style="text-align:center;">
      <div class="modal-header" style="justify-content:center; position:relative; margin-bottom:10px;">
        <h3 style="font-size:24px;">‚úÇÔ∏è Salon Essy</h3>
        <button class="modal-close" onclick="closeAboutModal()" style="position:absolute; right:0;"><i
            class="fas fa-times"></i></button>
      </div>
      <div style="color:var(--muted); font-size:14px; line-height:1.6; margin-bottom:20px;">
        <p style="font-weight:700; color:#fff; margin-bottom:4px;">Version 1.0.0</p>
        <p style="margin-bottom:16px;">The easiest way to book your next glow up. Find top-rated salons, view real-time
          availability, and secure your appointment in seconds.</p>
        <div style="display:flex; justify-content:center; gap:16px; margin-top:16px;">
          <a href="#" style="color:var(--purple); text-decoration:none; font-weight:600;">Privacy Policy</a>
          <span style="color:var(--border);">|</span>
          <a href="#" style="color:var(--purple); text-decoration:none; font-weight:600;">Terms of Service</a>
        </div>
      </div>
      <div style="font-size:12px; color:var(--muted); margin-top:24px;">¬© 2026 Salon Essy. All rights reserved.</div>
    </div>
  </div>

  <!-- ‚ïê‚ïê BOTTOM NAV ‚ïê‚ïê -->
  <nav class="bottom-nav">
    <button class="nav-item active" id="nav-home" onclick="switchScreen('home',this)"><i
        class="fas fa-home"></i>Home</button>
    <button class="nav-item" id="nav-search" onclick="switchScreen('search',this)"><i
        class="fas fa-search"></i>Search</button>
    <button class="nav-item" id="nav-bookings" onclick="switchScreen('bookings',this)"><i
        class="fas fa-calendar-check"></i>Bookings</button>
    <button class="nav-item" id="nav-favorites" onclick="switchScreen('favorites',this)"><i
        class="fas fa-heart"></i>Favorites</button>
    <button class="nav-item" id="nav-profile" onclick="switchScreen('profile',this)"><i
        class="fas fa-user"></i>Profile</button>
    <button class="nav-item" id="nav-settings" onclick="switchScreen('settings',this)"><i
        class="fas fa-cog"></i>Settings</button>
  </nav>

  <script>
    /* ‚îÄ‚îÄ SCREEN SWITCHER ‚îÄ‚îÄ */
    let currentScreen = 'home';
    function switchScreen(name, el) {
      currentScreen = name;
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('is-active'));
      const t = document.getElementById('screen-' + name);
      if (t) t.classList.add('is-active');
      // bottom nav
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      const nb = document.getElementById('nav-' + name);
      if (nb) nb.classList.add('active');
      // sidebar
      document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
      if (el && el.classList && el.classList.contains('sidebar-link')) el.classList.add('active');
      closeDropdowns();
      showSettingsBack(name === 'settings' || fromSettings);
      if (name !== 'settings' && name !== 'profile') fromSettings = false;
    }

    /* ‚îÄ‚îÄ CATEGORY FILTER ‚îÄ‚îÄ */
    let currentCat = '';
    let salonNames = [];
    let locationNames = [];
    let fromSettings = false;
    function filterCat(cat, el) {
      currentCat = cat;
      document.querySelectorAll('.cat-card').forEach(c => c.classList.remove('active'));
      if (el) el.classList.add('active');
      filterSalons();
    }

    /* ‚îÄ‚îÄ SALON FILTER ‚îÄ‚îÄ */
    function filterSalons() {
      const search = (document.getElementById('searchInput').value || '').toLowerCase();
      const locEl = document.getElementById('locationFilter');
      const loc = (locEl ? locEl.value : '').toLowerCase();

      const displayEl = document.getElementById('locationDisplay');
      if (displayEl && locEl) {
        displayEl.textContent = locEl.value ? locEl.options[locEl.selectedIndex].text + ', India' : 'All Cities, India';
      }

      const cards = document.querySelectorAll('#salonsList .salon-card');
      let visible = 0;

      cards.forEach(card => {
        const name = card.dataset.name || '';
        const location = (card.dataset.location || '').toLowerCase();
        const cats = (card.dataset.cats || '').toLowerCase();

        const matchSearch = !search || name.includes(search) || location.includes(search) || cats.includes(search);
        const matchLoc = !loc || location.includes(loc);
        const matchCat = !currentCat || cats.includes(currentCat.toLowerCase());

        const show = matchSearch && matchLoc && matchCat;
        card.style.display = show ? 'flex' : 'none';
        if (show) visible++;
      });
      document.getElementById('emptyState').style.display = visible === 0 ? 'block' : 'none';
    }

    /* ‚îÄ‚îÄ SEARCH SUGGESTIONS ‚îÄ‚îÄ */
    const searchInputEl = document.getElementById('searchInput');
    const suggBox = document.getElementById('searchSuggestions');
    const settingsBackBtn = document.getElementById('settingsBackBtn');
    function showSettingsBack(show) {
      if (settingsBackBtn) settingsBackBtn.style.visibility = show ? 'visible' : 'hidden';
      const pBack = document.getElementById('profileBackRow');
      if (pBack) pBack.style.display = show && fromSettings ? 'flex' : 'none';
    }

    /* ‚îÄ‚îÄ PROFILE PHOTO UPLOAD (client-side preview) ‚îÄ‚îÄ */
    const photoInput = document.getElementById('profilePhotoInput');
    const avatarImg = document.getElementById('profileAvatarImg');
    const avatarInitials = document.getElementById('profileAvatarInitials');
    function handlePhotoUpload(file) {
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        if (avatarImg) {
          avatarImg.src = e.target.result;
          avatarImg.style.display = 'block';
        }
        if (avatarInitials) avatarInitials.style.display = 'none';
        showToast('üì∏ Photo updated (preview only)');
      };
      reader.readAsDataURL(file);
    }
    if (photoInput) {
      photoInput.addEventListener('change', e => handlePhotoUpload(e.target.files[0]));
    }

    function buildSalonIndex() {
      const cards = document.querySelectorAll('.salon-card .salon-name');
      salonNames = Array.from(new Set(Array.from(cards).map(c => c.textContent.trim())))
        .filter(Boolean)
        .sort((a, b) => a.localeCompare(b));

      const locs = Array.from(document.querySelectorAll('.salon-card'))
        .map(c => (c.dataset.location || '').split(',')[0].trim())
        .filter(Boolean);
      locationNames = Array.from(new Set(locs)).sort((a, b) => a.localeCompare(b));
    }

    function renderSuggestions(query) {
      if (!suggBox || !searchInputEl) return;
      const q = (query || '').trim().toLowerCase();
      if (!q) {
        suggBox.style.display = 'none';
        suggBox.innerHTML = '';
        return;
      }

      const salonMatches = salonNames
        .filter(name => name.toLowerCase().startsWith(q))
        .slice(0, 5);

      const locMatches = locationNames
        .filter(city => city.toLowerCase().startsWith(q))
        .slice(0, 3);

      const matches = [
        ...locMatches.map(c => ({ type: 'city', label: c })),
        ...salonMatches.map(s => ({ type: 'salon', label: s }))
      ];

      if (!matches.length) {
        suggBox.style.display = 'none';
        suggBox.innerHTML = '';
        return;
      }

      suggBox.innerHTML = matches
        .map(item => `<div class="sugg-item" data-type="${item.type}" data-name="${item.label}">${item.type === 'city' ? 'üìç ' : 'üè™ '}${item.label}</div>`)
        .join('');
      suggBox.style.display = 'block';

      suggBox.querySelectorAll('.sugg-item').forEach(item => {
        item.addEventListener('mousedown', () => {
          const val = item.dataset.name;
          if (item.dataset.type === 'city') {
            const locEl = document.getElementById('locationFilter');
            const locPick = document.getElementById('locationPicker');
            if (locEl) {
              let option = Array.from(locEl.options).find(o => o.value === val);
              if (!option) {
                option = new Option(val, val);
                locEl.add(option);
              }
              locEl.value = val;
            }
            if (locPick) {
              let option = Array.from(locPick.options).find(o => o.value === val);
              if (!option) {
                option = new Option(val, val);
                locPick.add(option);
              }
              locPick.value = val;
            }
          } else {
            searchInputEl.value = val;
          }
          suggBox.style.display = 'none';
          filterSalons();
        });
      });
    }

    if (searchInputEl) {
      searchInputEl.addEventListener('input', (e) => {
        renderSuggestions(e.target.value);
      });
      searchInputEl.addEventListener('focus', (e) => {
        renderSuggestions(e.target.value);
      });
      searchInputEl.addEventListener('blur', () => {
        setTimeout(() => {
          if (suggBox) suggBox.style.display = 'none';
        }, 120);
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      buildSalonIndex();
      const locEl = document.getElementById('locationFilter');
      const locPick = document.getElementById('locationPicker');
      if (locEl && locPick) {
        locPick.value = locEl.value;
      }
      autoDetectLocation();
    });

    function syncLocation(val) {
      const locEl = document.getElementById('locationFilter');
      const locPick = document.getElementById('locationPicker');
      if (locEl) {
        let option = Array.from(locEl.options).find(o => o.value === val);
        if (!option) {
          option = new Option(val, val);
          locEl.add(option);
        }
        locEl.value = val;
      }
      if (locPick && locPick.value !== val) {
        let option = Array.from(locPick.options).find(o => o.value === val);
        if (!option) {
          option = new Option(val, val);
          locPick.add(option);
        }
        locPick.value = val;
      }
      filterSalons();
    }

    function openProfileFromSettings() {
      fromSettings = true;
      switchScreen('profile', document.getElementById('nav-profile'));
      showSettingsBack(true);
    }

    function returnFromProfileToSettings() {
      switchScreen('settings', document.querySelector('[data-target=\"settings\"]'));
      fromSettings = false;
      showSettingsBack(true);
    }

    /* ‚îÄ‚îÄ PROFILE DETAIL (loyalty / refer) ‚îÄ‚îÄ */
    function showProfileDetail(type) {
      const list = document.getElementById('profileList');
      const detail = document.getElementById('profileDetail');
      const title = document.getElementById('profileDetailTitle');
      const body = document.getElementById('profileDetailBody');
      if (!list || !detail || !title || !body) return;

      list.style.display = 'none';
      detail.style.display = 'block';

      if (type === 'loyalty') {
        title.textContent = 'Loyalty Points';
        body.innerHTML = `
          <p><strong>Balance:</strong> 540 pts</p>
          <p>Earn points on every booking. 1 pt = ‚Çπ1. Redeem at checkout for discounts.</p>
          <ul style="margin-left:18px; padding-left:0; color:#94a3b8;">
            <li>Haircut / Spa / Beauty Parlour: 5% of bill as points</li>
            <li>Bonus 100 pts on first booking each month</li>
            <li>Points expire after 12 months</li>
          </ul>
        `;
      } else {
        title.textContent = 'Refer & Earn';
        body.innerHTML = `
          <p><strong>Your code:</strong> SALON500</p>
          <p>Share this code with friends. When they sign up and complete their first booking, you get ‚Çπ500 wallet credit and they get ‚Çπ200 off.</p>
          <p style="margin-top:10px; color:#a5b4fc;">Tip: share via WhatsApp, SMS, or email.</p>
        `;
      }
    }

    function closeProfileDetail() {
      const list = document.getElementById('profileList');
      const detail = document.getElementById('profileDetail');
      if (list) list.style.display = 'flex';
      if (detail) detail.style.display = 'none';
    }

    // Try to auto-detect user's city via browser geolocation + reverse geocode
    function autoDetectLocation() {
      if (!navigator.geolocation) return;
      navigator.geolocation.getCurrentPosition(async (pos) => {
        const { latitude, longitude } = pos.coords;
        try {
          const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`);
          const data = await res.json();
          const city = data?.address?.city || data?.address?.town || data?.address?.village || data?.address?.state_district || data?.address?.state;
          if (city) {
            syncLocation(city);
          }
        } catch (e) {
          console.log('Geolocation lookup failed', e);
        }
      }, (err) => {
        console.log('Geolocation denied/failed', err);
      }, { timeout: 8000 });
    }

    /* ‚îÄ‚îÄ BOOKING TABS ‚îÄ‚îÄ */
    function switchTab(tab, btn) {
      ['upcoming', 'completed', 'cancelled'].forEach(t => {
        const el = document.getElementById('tab-' + t);
        if (el) el.style.display = t === tab ? 'block' : 'none';
      });
      document.querySelectorAll('.tab-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = 'var(--muted)';
        b.style.border = '1px solid var(--border)';
      });
      if (btn) {
        btn.style.background = 'rgba(168,85,247,0.2)';
        btn.style.color = 'var(--purple)';
        btn.style.border = 'none';
      }
    }

    /* ‚îÄ‚îÄ FAVORITES ‚îÄ‚îÄ */
    const favSalons = new Set();
    function toggleFav(btn) {
      const icon = btn.querySelector('i');
      icon.classList.toggle('far');
      icon.classList.toggle('fas');
      btn.style.background = icon.classList.contains('fas') ? 'rgba(236,72,153,0.2)' : 'rgba(236,72,153,0.1)';
      showToast(icon.classList.contains('fas') ? '‚ù§Ô∏è Added to favorites!' : 'üíî Removed from favorites');
    }

    /* ‚îÄ‚îÄ NOTIFICATIONS ‚îÄ‚îÄ */
    function toggleDropdown(id) {
      const d = document.getElementById(id);
      d.classList.toggle('open');
    }
    function closeDropdowns() {
      document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('open'));
    }
    document.addEventListener('click', e => {
      if (!e.target.closest('#notifBtn') && !e.target.closest('#notifDrop')) closeDropdowns();
    });

    /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
    function showToast(msg) {
      const t = document.getElementById('toastContainer');
      const el = document.createElement('div');
      el.className = 'toast'; el.textContent = msg;
      t.appendChild(el);
      setTimeout(() => el.remove(), 3000);
    }

    /* ‚îÄ‚îÄ MODAL LOGIC ‚îÄ‚îÄ */
    function openPasswordModal() { document.getElementById('passwordModal').style.display = 'flex'; }
    function closePasswordModal() { document.getElementById('passwordModal').style.display = 'none'; }
    function openHelpModal() { document.getElementById('helpModal').style.display = 'flex'; }
    function closeHelpModal() { document.getElementById('helpModal').style.display = 'none'; }
    function openAboutModal() { document.getElementById('aboutModal').style.display = 'flex'; }
    function closeAboutModal() { document.getElementById('aboutModal').style.display = 'none'; }

    function handlePasswordUpdate(e) {
      e.preventDefault();
      closePasswordModal();
      showToast('‚úÖ Password updated successfully!');
      e.target.reset();
    }

    /* ‚îÄ‚îÄ THEME TOGGLE ‚îÄ‚îÄ */
    function toggleTheme() {
      const isDark = document.getElementById('themeToggle').checked;
      const root = document.documentElement;
      const knob = document.getElementById('themeKnob');

      if (isDark) {
        root.style.setProperty('--dark', '#0f0a1e');
        root.style.setProperty('--card', 'rgba(255, 255, 255, 0.04)');
        root.style.setProperty('--border', 'rgba(255, 255, 255, 0.09)');
        root.style.setProperty('--text', '#e2e8f0');
        root.style.setProperty('--muted', '#64748b');
        document.body.style.background = '#0f0a1e';
        knob.style.left = '23px';
        knob.style.background = 'white';
        showToast('üåô Dark mode enabled');
      } else {
        root.style.setProperty('--dark', '#f8fafc');
        root.style.setProperty('--card', '#ffffff');
        root.style.setProperty('--border', '#e2e8f0');
        root.style.setProperty('--text', '#0f172a');
        root.style.setProperty('--muted', '#64748b');
        document.body.style.background = '#f8fafc';
        knob.style.left = '3px';
        knob.style.background = '#a855f7';
        showToast('‚òÄÔ∏è Light mode enabled');
      }
    }

    /* ‚îÄ‚îÄ CLOSE MODALS ON OUTSIDE CLICK ‚îÄ‚îÄ */
    document.querySelectorAll('.modal-overlay').forEach(overlay => {
      overlay.addEventListener('click', function (e) {
        if (e.target === this) this.style.display = 'none';
      });
    });

    /* ‚îÄ‚îÄ URL PARAM ‚îÄ‚îÄ */
    window.onload = () => {
      const p = new URLSearchParams(window.location.search).get('screen');
      if (p) switchScreen(p, null);
      filterSalons();
    };
  </script>
</body>

</html>
